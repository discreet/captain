#!/usr/bin/env ruby
#
# This will run a clean maven test. It is configured to run from the root of the
# project. If all tests pass it will exit 0.
#
require 'English'

def mavenTest
  scriptDir = File.expand_path(File.dirname(__FILE__))
  Dir.chdir(scriptDir)

  Dir.chdir('../../') do
    system('mvn clean test')
    if $CHILD_STATUS.exitstatus.zero?
      File.open('/tmp/hookStatus', 'a') { |f| f.write("maven: success\n") }
    end
    exit $CHILD_STATUS.exitstatus
  end
end
mavenTest
